{"ast":null,"code":"import _regeneratorRuntime from\"D:/Course 3/Semester_2/\\u0412\\u0435\\u0431/CashR(CourseWork)/front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Course 3/Semester_2/\\u0412\\u0435\\u0431/CashR(CourseWork)/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Course 3/Semester_2/\\u0412\\u0435\\u0431/CashR(CourseWork)/front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{useNavigate}from'react-router-dom';import\"./AuthReg.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(props){var navigate=useNavigate();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];function handleChangeEmail(event){setEmail(event.target.value);var value=event.target.elements.login.value;}function handleChangePassword(event){setPassword(event.target.value);}function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();user={email:email,password:password};_context.next=4;return fetch('http://localhost:5000/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(user)}).then(function(response){return response.json();}).then(function(data){if(data.token&&data.role[0]===\"Admin\"){localStorage.setItem('token',data.token);localStorage.setItem('role',data.role[0]);alert(data.message);var timer=setTimeout(function(){navigate('/users');},1000);}else if(data.token&&data.role[0]===\"User\"){localStorage.setItem('token',data.token);localStorage.setItem('role',data.role[0]);alert(data.message);navigate(\"/transactions\");}else{alert(data.message);}}).catch(function(error){return console.error(error);});case 4:case\"end\":return _context.stop();}},_callee);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"auth_reg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title_text\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\"})}),/*#__PURE__*/_jsxs(\"form\",{className:\"auth_reg_form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,placeholder:\"Введите почту\",onChange:function onChange(e){return setEmail(e.target.value);},required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,placeholder:\"Введите пароль\",onChange:function onChange(e){return setPassword(e.target.value);},required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"})]})]});};export default Login;","map":{"version":3,"names":["React","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","Login","props","navigate","_useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","handleChangeEmail","event","target","value","elements","login","handleChangePassword","handleSubmit","_x","_handleSubmit","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","user","wrap","_callee$","_context","prev","next","preventDefault","fetch","method","headers","body","JSON","stringify","then","response","json","data","token","role","localStorage","setItem","alert","message","timer","setTimeout","catch","error","console","stop","className","children","onSubmit","type","placeholder","onChange","e","required"],"sources":["D:/Course 3/Semester_2/Веб/CashR(CourseWork)/front/src/Components/Registration&Authorization/Login.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport {useNavigate} from 'react-router-dom';\r\nimport \"./AuthReg.css\";\r\n\r\nconst Login = (props) => {\r\n    const navigate = useNavigate();\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n\r\n    function handleChangeEmail(event) {\r\n        setEmail(event.target.value);\r\n        const { value } = event.target.elements.login;\r\n    }\r\n\r\n    function handleChangePassword(event) {\r\n        setPassword(event.target.value);\r\n    }\r\n\r\n    async function handleSubmit(event) {\r\n        event.preventDefault();\r\n        const user = {email, password};\r\n        await fetch('http://localhost:5000/auth/login', {\r\n            method: 'POST',\r\n            headers: {'Content-Type': 'application/json'},\r\n            body: JSON.stringify(user),\r\n        })\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                if (data.token && data.role[0] ===\"Admin\") {\r\n                    localStorage.setItem('token', data.token);\r\n                    localStorage.setItem('role', data.role[0]);\r\n\r\n                    alert(data.message);\r\n                    const timer = setTimeout(() => {\r\n                        navigate('/users');\r\n                    }, 1000);\r\n                }\r\n                else if(data.token && data.role[0] ===\"User\"){\r\n                    localStorage.setItem('token', data.token);\r\n                    localStorage.setItem('role', data.role[0]);\r\n                    alert(data.message);\r\n                    navigate(\"/transactions\");\r\n                }\r\n                else{\r\n                    alert(data.message);\r\n                }\r\n            })\r\n            .catch(error => console.error(error));\r\n    }\r\n\r\n    return (\r\n        <div className=\"auth_reg\">\r\n            <div className=\"title_text\">\r\n                <h1>Авторизация</h1>\r\n            </div>\r\n            <form className=\"auth_reg_form\" onSubmit={handleSubmit}>\r\n                <input type=\"email\" value={email} placeholder={\"Введите почту\"} onChange={(e) => setEmail(e.target.value)} required />\r\n                <input type=\"password\" value={password} placeholder={\"Введите пароль\"} onChange={(e) => setPassword(e.target.value)} required />\r\n                <button type=\"submit\">Авторизоваться</button>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}